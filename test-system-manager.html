<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>System Manager Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }
    
    .test-panel {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .test-panel h2 {
      margin-top: 0;
      color: #333;
    }
    
    .control-group {
      margin-bottom: 15px;
    }
    
    .control-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    .control-group select,
    .control-group input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    
    .status {
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 4px;
      border-left: 4px solid #007bff;
    }
    
    .status h3 {
      margin: 0 0 10px 0;
      color: #007bff;
    }
    
    .status p {
      margin: 5px 0;
      font-family: monospace;
      font-size: 12px;
    }
    
    .system-status {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    
    .system-item {
      padding: 8px;
      border-radius: 4px;
      font-size: 11px;
      text-align: center;
    }
    
    .system-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .system-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    .system-warning {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }
  </style>
</head>
<body>
  <h1>üöÄ System Manager Test</h1>
  
  <div class="test-container">
    <!-- Test Controls -->
    <div class="test-panel">
      <h2>üß™ Test Controls</h2>
      
      <div class="control-group">
        <label>Edge Style</label>
        <select id="edge-style">
          <option value="none">None</option>
          <option value="torn">Torn Paper</option>
          <option value="scalloped">Scalloped</option>
          <option value="zigzag">Zigzag</option>
          <option value="wave">Wavy</option>
          <option value="spikes">Spikes</option>
        </select>
      </div>
      
      <div class="control-group">
        <label>Edge Variant</label>
        <select id="edge-variant">
          <option value="default">Default</option>
          <option value="rough">Rough</option>
          <option value="smooth">Smooth</option>
          <option value="sharp">Sharp</option>
          <option value="soft">Soft</option>
        </select>
      </div>
      
      <div class="control-group">
        <label>Edge Thickness</label>
        <input type="range" id="edge-thickness" min="1" max="20" value="3">
        <span id="edge-thickness-value">3</span>px
      </div>
      
      <div class="control-group">
        <label>Edge Opacity</label>
        <input type="range" id="edge-opacity" min="0" max="1" value="0.8" step="0.1">
        <span id="edge-opacity-value">0.8</span>
      </div>
      
      <div class="control-group">
        <label>Edge Color</label>
        <input type="color" id="edge-color" value="#000000">
      </div>
      
      <div class="control-group">
        <label>Background Mode</label>
        <select id="bg-mode">
          <option value="color">Color</option>
          <option value="gradient">Gradient</option>
          <option value="texture">Texture</option>
          <option value="image">Image</option>
        </select>
      </div>
      
      <div class="control-group">
        <label>Overlay Style</label>
        <select id="overlay-style">
          <option value="frame-elegant">Elegant</option>
          <option value="frame-vintage">Vintage</option>
          <option value="frame-modern">Modern</option>
          <option value="frame-playful">Playful</option>
        </select>
      </div>
      
      <div class="control-group">
        <label>Accent Color</label>
        <input type="color" id="accent" value="#2ec5ff">
      </div>
      
      <div class="control-group">
        <label>Accent Color 2</label>
        <input type="color" id="accent2" value="#ff6b6b">
      </div>
    </div>
    
    <!-- System Status -->
    <div class="test-panel">
      <h2>üìä System Status</h2>
      
      <div class="status">
        <h3>System Manager Status</h3>
        <p id="manager-status">Initializing...</p>
        <p id="manager-details">Waiting for systems to load...</p>
      </div>
      
      <div class="status">
        <h3>Individual Systems</h3>
        <div class="system-status" id="system-status">
          <div class="system-item system-warning">Loading...</div>
        </div>
      </div>
      
      <div class="status">
        <h3>Test Results</h3>
        <p id="test-results">No tests run yet</p>
        <button id="run-tests" onclick="runSystemTests()">Run System Tests</button>
      </div>
    </div>
  </div>
  
  <!-- Preview Area -->
  <div style="margin-top: 30px; text-align: center;">
    <h2>üëÅÔ∏è Preview Area</h2>
    <div id="edge-layer" style="width: 400px; height: 300px; margin: 0 auto; border: 2px solid #ddd; border-radius: 8px; position: relative; background: #f9f9f9;">
      <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #666;">
        <h3>Edge Preview</h3>
        <p>Changes should appear instantly</p>
        <p>Current style: <span id="current-style">None</span></p>
      </div>
    </div>
  </div>
  
  <!-- Load Systems -->
  <script src="js/border-edges.js"></script>
  <script src="js/system-manager.js"></script>
  
  <script>
    // Test page logic
    let systemManager = null;
    
    // Wait for SystemManager to be ready
    const checkManager = setInterval(() => {
      if (window.systemManager && window.systemManager.initialized) {
        clearInterval(checkManager);
        systemManager = window.systemManager;
        console.log('‚úÖ Test page: SystemManager ready!');
        initializeTestPage();
      }
    }, 100);
    
    function initializeTestPage() {
      const managerStatus = document.getElementById('manager-status');
      const managerDetails = document.getElementById('manager-details');
      const systemStatus = document.getElementById('system-status');
      const testResults = document.getElementById('test-results');
      
      // Update manager status
      managerStatus.textContent = 'Ready';
      managerDetails.textContent = 'All systems initialized successfully';
      
      // Update system status
      updateSystemStatus();
      
      // Update current style display
      function updateCurrentStyle() {
        const currentStyle = document.getElementById('current-style');
        if (systemManager.getSystem('borderEdges')) {
          currentStyle.textContent = systemManager.getSystem('borderEdges').settings.style;
        }
      }
      
      // Initial update
      updateCurrentStyle();
      
      console.log('‚úÖ Test page: Initialization complete');
    }
    
    function updateSystemStatus() {
      const systemStatus = document.getElementById('system-status');
      const systems = systemManager.getAllSystems();
      
      systemStatus.innerHTML = '';
      
      const systemNames = [
        'borderEdges', 'overlay', 'background', 'text', 
        'color', 'font', 'shadow', 'sprite', 'particle'
      ];
      
      systemNames.forEach(name => {
        const system = systems.get(name);
        const div = document.createElement('div');
        div.className = 'system-item';
        
        if (system) {
          div.className += ' system-success';
          div.textContent = `${name}: ‚úÖ`;
        } else {
          div.className += ' system-error';
          div.textContent = `${name}: ‚ùå`;
        }
        
        systemStatus.appendChild(div);
      });
    }
    
    function runSystemTests() {
      const testResults = document.getElementById('test-results');
      testResults.textContent = 'Running tests...';
      
      try {
        // Test Border Edges System
        const borderEdges = systemManager.getSystem('borderEdges');
        if (borderEdges) {
          borderEdges.test();
          testResults.textContent = '‚úÖ All tests passed! Border Edges working correctly.';
        } else {
          testResults.textContent = '‚ùå Border Edges system not found!';
        }
        
        // Update system status
        updateSystemStatus();
        
      } catch (error) {
        testResults.textContent = `‚ùå Test failed: ${error.message}`;
        console.error('Test error:', error);
      }
    }
    
    // Update edge thickness and opacity displays
    document.getElementById('edge-thickness').addEventListener('input', (e) => {
      document.getElementById('edge-thickness-value').textContent = e.target.value;
    });
    
    document.getElementById('edge-opacity').addEventListener('input', (e) => {
      document.getElementById('edge-opacity-value').textContent = e.target.value;
    });
  </script>
</body>
</html>
